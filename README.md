# T6 String Optimizer for GSC
This is a small tool that tries to reduce the number of varname strings used for a compiled script. This was my first ever attempt at modifying a gsc compiler and as such is a really dumb way of doing things, but it works (mostly)!! This project is from 2016 and I have no intentions of providing support or answering questions. GSX Studio uses this as a base for the compiler lib, but GSX studio is ultimately much improved, and the t6 compiler i developed and keep forgetting to release is **very much** improved.
## How does this work?
Scripts compiled for t6 include every variable name and readonly notify string as a canonical string which must be added to the stringtable for the vm. This includes local variables and function names which are otherwise not important to the functionality of the script being compiled. This project takes existing strings from analysing the gsc dumps and replaces the local var names found in your script with existing ones, such that new entries do not get added to the string table. It can be further configured to work on field variable references and globals if they dont need to be externally used.
## How can this be improved?
To be blunt: this does not even need to be done at compilation time. I did a source to source generator but you can *easily* modify the emitted string table of a precompiled gsc object and remove any string which is not a function name or global name. To do this, create a hashtable of all of the stringrefs and their usage in the binary. iterate every function and find any instance of the opcreatesafevariables opcode. for each parameter, replace its nameref to 1 string (you can even reuse the same name for every param), increment that string's use counter, and decrement the existing one. When a string hits 0 usage, remove it from the table. Re-emit the string table that has been optimized. You are guaranteed to have the same number or less of fixups and table entries so the memory does not need to be resized.
